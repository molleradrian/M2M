<div class="flex flex-col h-[85vh] max-w-3xl mx-auto">
  <header class="pb-6 border-b border-stone-200 text-center">
    <h2 class="text-4xl font-bold text-stone-800">The Co-Ordinator</h2>
    <p class="mt-2 text-lg text-stone-600">Your AI-powered wedding planning assistant.</p>
  </header>

  <!-- Chat Messages -->
  <div class="flex-grow bg-white my-6 p-6 rounded-2xl shadow-md border border-stone-200 overflow-y-auto">
    <div class="space-y-6">
      @for(message of messages(); track $index) {
        <div class="flex" [class.justify-end]="message.sender === 'user'" [class.justify-start]="message.sender === 'ai'">
          <div 
            class="max-w-md p-4 rounded-2xl"
            [class.bg-rose-500]="message.sender === 'user'"
            [class.text-white]="message.sender === 'user'"
            [class.bg-stone-200]="message.sender === 'ai'"
            [class.text-stone-800]="message.sender === 'ai'"
            [class.rounded-br-none]="message.sender === 'user'"
            [class.rounded-bl-none]="message.sender === 'ai'">
            <p [innerHTML]="formatMessage(message.text)"></p>
          </div>
        </div>
      }

      @if (isLoading()) {
        <div class="flex justify-start">
          <div class="max-w-md p-4 rounded-2xl bg-stone-200 text-stone-800 rounded-bl-none">
            <div class="flex items-center space-x-2">
                <span class="w-2 h-2 bg-stone-500 rounded-full animate-pulse" style="animation-delay: 0ms;"></span>
                <span class="w-2 h-2 bg-stone-500 rounded-full animate-pulse" style="animation-delay: 200ms;"></span>
                <span class="w-2 h-2 bg-stone-500 rounded-full animate-pulse" style="animation-delay: 400ms;"></span>
            </div>
          </div>
        </div>
      }
    </div>
  </div>

  <!-- Predefined Questions -->
  <div class="flex flex-wrap gap-2 justify-center mb-4">
      @for(question of predefinedQuestions; track question) {
        <button 
          (click)="sendMessage(question)"
          class="px-4 py-2 bg-white border border-rose-300 text-rose-700 rounded-full text-sm hover:bg-rose-50 transition-colors">
          {{ question }}
        </button>
      }
  </div>

  <!-- Input Form -->
  <form (submit)="sendMessage()" class="flex items-center gap-4">
    <input 
      type="text" 
      [ngModel]="userInput()"
      (ngModelChange)="userInput.set($event)"
      [disabled]="isLoading()"
      placeholder="Type your question here..."
      class="flex-grow p-4 border border-stone-300 rounded-full focus:ring-2 focus:ring-rose-400 focus:border-rose-400 outline-none transition duration-200 disabled:bg-stone-100">
    <button 
      type="submit"
      [disabled]="isLoading() || userInput().trim() === ''"
      class="bg-rose-500 text-white rounded-full p-4 hover:bg-rose-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500 disabled:bg-rose-300 disabled:cursor-not-allowed transition-colors duration-200">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M5 10l7-7m0 0l7 7m-7-7v18" />
      </svg>
    </button>
  </form>
</div>